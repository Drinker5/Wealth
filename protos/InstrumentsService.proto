syntax = "proto3";

import "Common.proto";

package wealth;

option csharp_namespace = "Wealth.InstrumentManagement";

service InstrumentsService {
  rpc GetBond (GetBondRequest) returns (GetBondResponse);
  rpc GetStock (GetStockRequest) returns (GetStockResponse);
  rpc GetStocks (GetStocksRequest) returns (GetStocksResponse);
  rpc GetCurrency (GetCurrencyRequest) returns (GetCurrencyResponse);
  rpc CreateStock (CreateStockRequest) returns (CreateStockResponse);
  rpc CreateBond (CreateBondRequest) returns (CreateBondResponse);
  rpc CreateCurrency (CreateCurrencyRequest) returns (CreateCurrencyResponse);
  rpc ChangeStockPrice (ChangeStockPriceRequest) returns (ChangePriceResponse);
  rpc ChangeBondPrice (ChangeBondPriceRequest) returns (ChangePriceResponse);
  rpc ChangeCurrencyPrice (ChangeCurrencyPriceRequest) returns (ChangePriceResponse);
  rpc GetInstruments (GetInstrumentsRequest) returns (GetInstrumentsResponse);
  rpc ImportInstruments (ImportInstrumentsRequest) returns (GetInstrumentsResponse);
}

// get by bondId, isin, figi or uid
message GetBondRequest {
  oneof variant {
    BondIdProto bond_id = 1;
    ISINProto isin = 2;
    string figi = 3;
    InstrumentIdProto instrument_id = 4;
  }
}

// get by stockId, isin, figi or figi
message GetStockRequest {
  oneof variant {
    StockIdProto stock_id = 1;
    ISINProto isin = 2;
    string figi = 3;
    InstrumentIdProto instrument_id = 4;
  }
}

message GetStocksRequest {
  repeated StockIdProto stock_ids = 1;
}

message GetCurrencyRequest {
  oneof variant {
    CurrencyIdProto currency_id = 1;
    string figi = 2;
    InstrumentIdProto instrument_id = 3;
  }
}

message GetBondResponse {
  BondIdProto bond_id = 1;
  string name = 2;
  MoneyProto price = 3;
  ISINProto isin = 4;
  string figi = 5;
  InstrumentIdProto instrument_id = 6;
}

message GetStockResponse {
  StockInfoProto stock_info = 1;
}

message GetStocksResponse{
  repeated StockInfoProto stock_infos = 1;
}

message StockInfoProto {
  StockIdProto stock_id = 1;
  string name = 2;
  MoneyProto price = 3;
  ISINProto isin = 4;
  string figi = 5;
  int32 lot_size = 6;
  MoneyProto dividend_per_year = 7;
  string ticker = 8;
  InstrumentIdProto instrument_id = 9;
}

message GetCurrencyResponse {
  CurrencyIdProto currency_id = 1;
  string name = 2;
  MoneyProto price = 3;
  string figi = 4;
  InstrumentIdProto instrument_id = 5;
}

message CreateStockRequest {
  string name = 1;
  ISINProto isin = 2;
  string figi = 3;
  int32 lot_size = 4;
  string ticker = 5;
  InstrumentIdProto instrument_id = 6;
}

message CreateStockResponse {
  StockIdProto stock_id = 1;
}

message CreateBondRequest {
  string name = 1;
  ISINProto isin = 2;
  string figi = 3;
  InstrumentIdProto instrument_id = 4;
}

message CreateCurrencyRequest {
  string name = 1;
  string figi = 2;
  InstrumentIdProto instrument_id = 3;
}

message CreateBondResponse {
  BondIdProto bond_id = 1;
}

message CreateCurrencyResponse {
  CurrencyIdProto currency_id = 1;
}

message ChangeStockPriceRequest {
  StockIdProto stock_id = 1;
  MoneyProto price = 2;
}

message ChangeBondPriceRequest {
  BondIdProto bond_id = 1;
  MoneyProto price = 2;
}

message ChangeCurrencyPriceRequest {
  CurrencyIdProto currency_id = 1;
  MoneyProto price = 2;
}

message ChangePriceResponse {
}

message GetInstrumentsRequest {
  repeated InstrumentIdProto instrument_ids = 1;
}

message GetInstrumentsResponse {
  repeated InstrumentProto instruments = 1;
}

message InstrumentProto {
  InstrumentIdProto instrument_id = 1;
  int32 id = 2;
  InstrumentTypeProto type = 3;
}

message ImportInstrumentsRequest {
  repeated InstrumentIdProto stock_instrument_ids = 1;
  repeated InstrumentIdProto bond_instrument_ids = 2;
  repeated InstrumentIdProto currency_instrument_ids = 3;
}